@model WAMVC.Models.PedidoModel

@{
    ViewData["Title"] = "Detalles del Pedido";
}

<div class="row mb-4">
    <div class="col">
        <h1 class="form-title">
            <i class="bi bi-receipt me-2"></i>Detalles del Pedido
        </h1>
    </div>
</div>

<div class="form-container">
    <div class="row">
        <div class="col-md-6">
            <dl class="row">
                <dt class="col-sm-4">
                    @Html.DisplayNameFor(model => model.Cliente)
                </dt>
                <dd class="col-sm-8">
                    @Html.DisplayFor(model => model.Cliente.Nombre)
                </dd>
                <dt class="col-sm-4">
                    @Html.DisplayNameFor(model => model.FechaPedido)
                </dt>
                <dd class="col-sm-8">
                    @Model.FechaPedido.ToString("dd/MM/yyyy")
                </dd>
                <dt class="col-sm-4">
                    @Html.DisplayNameFor(model => model.Estado)
                </dt>
                <dd class="col-sm-8">
                    <span class="badge @(Model.Estado == "Completado" ? "bg-success" : 
                           Model.Estado == "Cancelado" ? "bg-danger" : 
                           Model.Estado == "En proceso" ? "bg-primary" : "bg-warning")">
                        @Html.DisplayFor(model => model.Estado)
                    </span>
                </dd>
                <dt class="col-sm-4">
                    @Html.DisplayNameFor(model => model.MontoTotal)
                </dt>
                <dd class="col-sm-8">
                    <strong>$@Html.DisplayFor(model => model.MontoTotal)</strong>
                </dd>
            </dl>
            
            <div class="form-buttons">
                <a asp-action="Edit" asp-route-id="@Model?.Id" class="btn-form-primary">
                    <i class="bi bi-pencil"></i> Editar
                </a>
                <a asp-action="Index" class="btn-form-secondary">
                    <i class="bi bi-arrow-left"></i> Volver a la Lista
                </a>
                <a asp-controller="DetallePedido" asp-action="Create" asp-route-pedidoId="@Model?.Id" class="btn btn-accent">
                    <i class="bi bi-plus"></i> Agregar Productos
                </a>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="alert alert-info">
                <h5 class="alert-heading"><i class="bi bi-info-circle me-2"></i>Información del Pedido</h5>
                <p>Este es el detalle del pedido realizado. Puede editarlo o agregar productos al pedido según sea necesario.</p>
            </div>
        </div>
    </div>
    
    @if (Model.DetallePedidos != null && Model.DetallePedidos.Any())
    {
        <div class="row mt-4">
            <div class="col-12">
                <h4><i class="bi bi-box-seam me-2"></i>Productos en este Pedido</h4>
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-primary">
                            <tr>
                                <th>Producto</th>
                                <th>Cantidad</th>
                                <th>Precio</th>
                                <th>Subtotal</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var detalle in Model.DetallePedidos)
                            {
                                <tr>
                                    <td>@detalle.Producto?.Nombre</td>
                                    <td>@detalle.Cantidad</td>
                                    <td>$@detalle.PrecioUnitario</td>
                                    <td><strong>$@(detalle.Cantidad * detalle.PrecioUnitario)</strong></td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    }
    else
    {
        <div class="row mt-4">
            <div class="col-12">
                <div class="alert alert-warning">
                    <h5 class="alert-heading"><i class="bi bi-exclamation-triangle me-2"></i>Sin Productos</h5>
                    <p>Este pedido no tiene productos agregados. Utilice el botón "Agregar Productos" para añadir productos al pedido.</p>
                </div>
            </div>
        </div>
    }
</div>
